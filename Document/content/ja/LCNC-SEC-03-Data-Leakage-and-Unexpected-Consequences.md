# LCNC-SEC-03: データ漏洩と予期せぬ事態

## リスク評価 [*](https://owasp.org/www-project-top-ten/2017/Note_About_Risks)

| 普及度 | 検出難易度 | 悪用難易度 | 技術的影響 |
| --- | --- | --- | --- |
| 3 | 2 | 3 | 3 |

## 要旨

ノーコード/ローコードアプリケーションは基盤となるサービスから合法的にデータにアクセスしますが、予期されていないまたは承認されていないアクションに対してそれらのバックエンドシステムへの導管として機能することもあります。
これにはアプリケーションやセキュリティの境界を越えたデータ漏洩、データに対する作成、読み取り、更新、削除操作のトリガー、偶発的もしくは悪意のあるデータ流出など、意図しない副作用が含まれます。

## 説明

ノーコード/ローコードアプリケーションは多くの場合、データにアクセスしたり、基盤となるサービスに対して操作を実行します。
データオペレータとして、ノーコード/ローコードアプリケーションは指定されたストレージの外や組織の境界の外にデータを移動することで簡単にデータ漏洩を引き起こす可能性があります。

場合によっては、ノーコード/ローコードアプリケーションを使用して複数のシステム間でデータを同期したり、あるシステムの変更によって別のシステムでの操作をトリガーできます。
操作のトリガーとして、ノーコード/ローコードアプリケーションはあるシステム内での操作と別のシステムの変更を暗黙のうちに結び付けることで、予期せぬ事態を招く可能性があります。
さらに、複数のアプリケーションが一つのデータソースに接続してトリガーできるため、データの移動や操作のトリガーが連鎖的に発生し、予測することも完全なマッピングも困難になります。

## 攻撃シナリオの例

### シナリオ #1

ある開発者はあるアプリケーションに企業のデータベースへのアクセスを許可しました。
このアプリケーションは他のユーザーと共有され、承認やアクセス要求のプロセスを経ることなく、データベースへの暗黙的なアクセスを許可します。

### シナリオ #2

ある開発者は会社のメールボックスに新しい電子メールが届くたびにトリガーするオートメーションを設定しました。
オートメーションは会社のメールボックスで受信したオリジナルの電子メールから受信者、件名、本文をコピーして、開発者個人の電子メールアカウントに新しい電子メールを送信します。
会社のメールボックスから転送される電子メールではなく別のメールボックスにデータがコピーされるため、このオートメーションは DLP コントロールをバイパスします。

### シナリオ #3

開発者 #1 は二つの SharePoint サイト間で変更を同期するオートメーションを設定し、サイト A 上のすべての新しいファイルがサイト B にコピーされるようにしました。
ユーザー #2 は機密文書を誤ってサイト A に書き込んでしまいましたが、それがサイト B に複製されることを知りませんでした。
ユーザー #2 はサイト A からその文書を削除しました。
しかし、その文書はまだサイト B 上に存在しています。

## 防止方法

- コネクタを承認済みサービスリストに制限する。
- カスタムコネクタの作成を専任の担当者に制限する。
- マルチホップパスなど、組織の境界外のデータフローについてプラットフォームを監視する。

## 参考資料

- [Low-Code Security and Business Email Compromise via Email Auto-Forwarding](https://www.zenity.io/blog/low-code-security-and-business-email-compromise-via-email-auto-forwarding/)
- [Hackers Abuse Low-Code Platforms And Turn Them Against Their Owners](https://www.zenity.io/blog/hackers-abuse-low-code-platforms-and-turn-them-against-their-owners/)
