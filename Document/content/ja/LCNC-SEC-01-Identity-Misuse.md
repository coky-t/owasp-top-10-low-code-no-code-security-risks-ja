# LCNC-SEC-01: ID の誤用

## リスク評価 [*](https://owasp.org/www-project-top-ten/2017/Note_About_Risks)

| 普及度 | 検出難易度 | 悪用難易度 | 技術的影響 |
| --- | --- | --- | --- |
| 3 | 2 | 3 | 3 |

## 要旨

ノーコード/ローコードアプリケーションには任意のアプリケーションユーザーが暗黙的に使用するユーザー ID を埋め込むことができます。
これは権限昇格への直接的な経路を作り出し、攻撃者が他のユーザーの ID の後ろに隠れることを可能にし、従来のセキュリティコントロールを回避できてしまいます。

## 説明

ノーコード/ローコードアプリケーションは独自のアプリケーション ID を持つのではなく、既存のユーザー ID を利用できます。
組み込まれた ID はアプリケーションの作成者のものであったり、データベースへの資格情報のようにチームで共有される共通の ID であったりします。

アプリケーションの ID がないため、ノーコード/ローコードプラットフォームの外部にある実施システムや監視システムに対して、アプリケーションは透過的になってしまいます。
外部の閲覧者としては、アプリケーションを使用するユーザーはアプリケーション作成者になりすますことになります。
アプリケーションとその作成者がないのです。
アプリケーションが複数の ID を使用して複数の異なるプラットフォームで動作する場合、問題はさらに深刻になります。
あるユーザーはファイル共有 SaaS にファイルを保存するために使用し、別のユーザーはオンプレミスのデータを取得するために使用することができます。

さらに、ID はアプリケーション内に組み込まれ、そのアプリケーションは複数のユーザーによって使用される可能性があります。
これは権限昇格への直接的な道筋を作り出し、アプリケーションユーザーが本来持つべきではないアクセス権を取得できてしまいます。

## 攻撃シナリオの例

探索案 (TBD):
- アプリケーションにメーカーの資格情報が組み込まれており、アプリユーザーに暗黙的に使用される
- アプリケーションはビジネス、個人、ベンダーの ID を混ぜて使用する
- アプリのなりすまし: ユーザーはデフォルトでローコードアプリを信頼する

### シナリオ #1

TBD

### シナリオ #2

TBD

## 防御方法

- 外部サービスへの接続をプロビジョニングする際、最小権限の原則を遵守する。
- アプリケーションではユーザーアカウントではなく専用のサービスアカウントを使用する。
- アプリケーションでは接続ごとに異なる ID ではなく、すべての接続で単一の一貫した ID を使用する。

## 参考資料

- [Why So Many Security Experts Are Concerned About Low-Code/No-Code Apps](https://www.darkreading.com/dr-tech/why-so-many-security-experts-are-concerned-about-low-code-no-code-apps)
