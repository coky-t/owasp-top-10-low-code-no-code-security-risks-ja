# LCNC-SEC-02: 資格情報処理の不備

## リスク評価 [*](https://owasp.org/www-project-top-ten/2017/Note_About_Risks)

| 普及度 | 検出難易度 | 悪用難易度 | 技術的影響 |
| --- | --- | --- | --- |
| 3 | 3 | 3 | 3 |

## 要旨

サービスコネクションはほとんどのノーコード/ローコードプラットフォームでファーストクラスのオブジェクトであり、アプリケーション間、他のユーザー、または組織全体で共有できることを意味します。

## 説明

ノーコード/ローコードアプリケーションはサイロ (縦割り組織) で構築されるものではありません。
その影響はオンプレミス、SaaS、PaaS、クラウドにまたがり統合された組織スタック全体に及びます。
ほとんどのノーコード/ローコードプラットフォームには多数のコネクタセット、つまり API のラッパーが多数組み込まれており、すばやく簡単に接続できます。
コネクタはユーザー資格情報と結合してコネクションを形成し、ほとんどのノーコード/ローコードプラットフォームでファーストクラスのオブジェクトとなります。
これはアプリケーション間、他のユーザー、または組織全体でコネクションが共有されることを意味します。

生産性を高め、配信までの時間を短縮するために、多くのノーコード/ローコードプラットフォームはユーザーリフレッシュトークンをクエリして保存し、それらを勝手に再利用することで OAuth 認証フローを悪用しています。
これによりビジネスユーザーはシークレットやパーミッションについて考えることなくコネクションをすばやく設定できますが、コネクションには監視や取消が難しいユーザー ID が組み込まれていることを意味します。
OAuth リフレッシュトークンは有効期限が短くなるように設計されていますが、ほとんどの場合、数か月から数年も有効であることがよくあります。
したがって、ビジネスユーザーが短時間で作成したコネクションは、ノーコード/ローコードプラットフォームで長期間存続し、他のユーザーによって本来の意図とは異なる目的で使用されることがよくあります。

## 攻撃シナリオの例

探索案 (TBD):
- 共有コネクションにより権限昇格が有効になる
- 共有コネクションがアカウントの乗っ取りにつながる (例: "パスワード忘れ")
- デフォルト設定でユーザーが自分の資格情報を他者と共有するよう促している

### シナリオ #1

TBD

### シナリオ #2

TBD

## 防御方法

- 暗黙のうちに共有されるコネクションを使用できないようにするか、または監視する。
- 共有コネクションを含む可能性がある環境へのアクセスを提供する際には、最小権限の原則を遵守する。
- ノーコード/ローコードプラットフォームの過剰な共有コネクションを監視する。
- コネクション共有のリスクと資格情報共有との関係についてビジネスユーザーに教育する。

## 参考資料

- [Low-Code Platforms Are the New Holy Grail for Hackers](https://www.zenity.io/blog/why-are-low-code-platforms-becoming-the-new-holy-grail-of-cyberattackers/)
