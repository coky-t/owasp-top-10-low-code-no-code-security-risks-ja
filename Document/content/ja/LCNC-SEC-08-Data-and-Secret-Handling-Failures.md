# LCNC-SEC-08: データとシークレットの処理の不備

## リスク評価 [*](https://owasp.org/www-project-top-ten/2017/Note_About_Risks)

| 普及度 | 検出難易度 | 悪用難易度 | 技術的影響 |
| --- | --- | --- | --- |
| 3 | 2 | 3 | 3 |

## 要旨

ノーコード/ローコードアプリケーションはデータやシークレットを「コード」の一部として、あるいはプラットフォームが提供するマネージドデータベースに保存することが多く、これらは規制やセキュリティ要件に準拠して適切に保存する必要があります。

## 説明

ノーコード/ローコードアプリケーションはデータやシークレットを「コード」の一部として、あるいはプラットフォームが提供するマネージドデータベースに保存できます。
ノーコード/ローコードベンダーが管理するデータベースに保存されるデータには、個人情報や金融データなどの機密データが含まれることがよくあります。
アプリケーションの作成者はデータをどのように保存するかを決めることができますが、管理者はこのようなマネージドデータベースを見ることができないことがよくあります。
多くの場合、機密データは暗号化されずに保存され、規制要件を考慮することなく地理的位置間で移動が行われています。

さらに、アプリケーションの作成者にはシークレットを「コード」にハードコードすることが多くあります。
環境変数、コンフィグレーション、コードのいずれであっても、アプリケーションはサービスにアクセスするためにハードコードされたシークレットに依存することがよくあります。
ハードコードされたシークレットはアプリケーションへの書き込み権限を持つすべてのユーザーが利用でき、クライアント側のコードを介してアプリケーションリーダーや匿名ユーザーに漏洩する可能性もあります。

さらに、多くのネイティブログストリームにはアプリケーションログ、メトリクス、およびアプリケーションを通過する機密データが混在しています。
多くのプラットフォームではアプリケーションがデフォルトで使用する実際のデータポイントをログに含みます。

## 攻撃シナリオの例

### シナリオ #1

ある作成者は機密データとなるフォームへの入力をユーザーに求めるビジネスアプリケーションを作成しました。
プラットフォームが提供するマネージドデータベースを使用して結果を保存します。
マネージドデータベースはデフォルトで他のすべての作成者と一所に保存されるため、すべての作成者は機密データにアクセスできてしまいます。

### シナリオ #2

ある作成者はカスタム API を使用するアプリケーションを作成し、そのコードに API キーをハードコードしました。
他の作成者はその API キーに直接アクセスできます。
さらに、その API キーがアプリのクライアントコードに漏洩し、ユーザーがそのキーに直接アクセスできるようになる可能性があります。

## 防止方法

- データストレージに関連するコンプライアンス、プライバシー、セキュリティリスクについてビジネスユーザーに教育する。
- ノーコード/ローコードベンダーが提供するマネージドデータベース、環境変数、コンフィグレーションに機密データがないか監視する。
- 機密データにアクセスするアプリケーションにはセキュリティチームが関与する。

## 参考資料

- [Establishing a DLP strategy](https://docs.microsoft.com/en-us/power-platform/guidance/adoption/dlp-strategy)
