---

layout: col-sidebar
title: "LCNC-SEC-10: セキュリティログと監視の不備"

---

## リスク評価 [*](https://owasp.org/www-project-top-ten/2017/Note_About_Risks)

| 普及度 | 検出難易度 | 悪用難易度 | 技術的影響 |
| --- | --- | --- | --- |
| 2 | 2 | 3 | 2 |

## 要旨

ローコード/ノーコードアプリケーションは包括的な監査証跡を欠いたり、不十分なログや存在しないログを生成したり、機密ログへのアクセスが過度に共有されていることがよくあります。

## ビジネスユーザーへの説明

アプリケーションを実行する際、何が実行されたか、そのアプリケーションやユーザーが取ったアクションを把握すること (監査証跡ともよばれます) が非常に重要です。これは多くの場合、特定のアクションのログ記録を使用して行われます。侵害や悪意のあるアクティビティが発生した場合、何が起こったのか、どのように回復するのかを理解するには監査ログが鍵となります。このリスクは実行中のシステムがログ記録する情報が多すぎたり少なすぎたりする場合に発生します。情報のコストと品質とのバランスをとる必要があります。

## 説明

ローコード/ノーコードアプリケーションはログ生成やデータ監視をベンダーに依存することがよくあります。
多くの場合、ログは不十分か収集されておらず、セキュリティ調査を妨げ、コンプライアンス要件に起因する監査の失敗につながる可能性があります。

さらに、個々のリソースには包括的な監査証跡がないことが多く、変更管理プロセスや問い合わせの妨げになります。
誰がその変更を持ち込んだかを見つけるのは、手に負えない課題となります。

## 攻撃シナリオの例

### シナリオ #1

アプリケーションのログはオフになっています。
侵害が試みられた場合、セキュリティチームは誰がアプリにアクセスし、何をしようとしたのかを判断できません。

### シナリオ #2

ビジネスクリティカルなアプリケーションがある変更後に機能しなくなりました。
複数の変更が発生し、それぞれがアプリケーションの更新につながるため、問題の原因となった特定の変更を持ち込んだ開発者を見つけることは困難です。
開発者たちは問題のあるバージョンを見つけるために、各アプリケーションのバージョンを手作業で確認する必要があります。
各アプリケーションの「保存」は更新につながるため、更新の数が多ければ多いほど手作業には法外な費用と時間がかかります。
一部のプラットフォームでは、開発者は現在のバージョンのアプリケーションしか確認できないため、安定したバージョンを見つけたり戻したりすることができません。

## 攻撃と悪用のシナリオの例 - ビジネスユーザー

### シナリオ #1

ある開発者は金融システムにデータをロードして注文処理を完了する自動プロセスを構築しました。このプロセスは週に約千のトランザクションを処理し、成功率は 97% でした。失敗した 3% は毎日送信される「トランザクション失敗」電子メールから手作業で処理します。

「トランザクション失敗」電子メールは数日間送信に失敗しており、その欠如は通知されませんでした。ログ記録が不十分なため、失敗したレコードを簡単に見つける方法がありません。代わりにすべてのトランザクションの 100% を調査して失敗を見つける必要があり、非常に大きなタスクとなります。

### シナリオ #2

カンファレンスでクレジットカード決済を処理するアプリケーションが作成されました。その作成の一環として、トランザクションを追跡するための詳細なログファイルが作成され、共有ネットワークドライブに保存されます。ログ記録にはクレジットカード情報の記録も含みます。ネットワークドライブを閲覧しているユーザーがこのファイルを発見し、すべてのクレジットカードデータを取得できます。

## 防止方法

- プラットフォームのビルトイン機能を活用して、ユーザーアクセスやプラットフォームの監査ログを収集する。
- 適用可能であれば、アプリケーションにログ収集のメカニズムを組み込み、可視性を向上させる。
- アプリケーションの生データをログ収集しないようにプラットフォームを設定し、ログが機密データで汚染されないようにする。

## 参考資料

- [No-Code Malware - Windows 11 at Your Service, DEF CON 2022](https://www.youtube.com/watch?v=e8PEIOa6W9M)
- [Full Operational Shutdown—another cybercrime case from the Microsoft Detection and Response Team](https://www.microsoft.com/en-us/security/blog/2020/04/02/full-operational-shutdown-another-cybercrime-case-microsoft-detection-and-response-team/)
- [A08:2021 – Software and Data Integrity Failures, OWASP Top 10](https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/)
