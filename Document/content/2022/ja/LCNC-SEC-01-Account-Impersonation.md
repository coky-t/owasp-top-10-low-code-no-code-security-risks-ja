---

layout: col-sidebar
title: "LCNC-SEC-01: アカウントのなりすまし"

---

## リスク評価 [*](https://owasp.org/www-project-top-ten/2017/Note_About_Risks)

| 普及度 | 検出難易度 | 悪用難易度 | 技術的影響 |
| --- | --- | --- | --- |
| 3 | 2 | 3 | 3 |

## 要旨

ノーコード/ローコードアプリケーションには任意のアプリケーションユーザーが暗黙的に使用する開発者アカウントを埋め込むことができます。
これは権限昇格への直接的な経路を作り出し、攻撃者が他のユーザーの ID の後ろに隠れることを可能にし、従来のセキュリティコントロールを回避できてしまいます。

## 説明

ID はアプリケーション内に組み込まれ、複数のユーザーがそのアプリケーションを使用できます。
これは権限昇格への直接的な道筋を作り出し、アプリケーションユーザーが本来持つべきではないアクセスレベルを取得できてしまいます。

ノーコード/ローコードアプリケーションは独自のアプリケーション ID を持つのではなく、既存のユーザー ID を利用できます。
組み込まれた ID はアプリケーションの作成者に属するものであったり、データベース資格情報のようにチームで共有される共通の ID であったりします。

アプリケーションの ID がないため、ノーコード/ローコードプラットフォームの外部にある監視システムに機密データが露出することになります。
外部から見ると、アプリケーションを使用するユーザーはアプリケーションの作成者になりすますことになり、アプリケーションとその作成者を区別することはできません。
アプリケーションが異なる ID を使用してさまざまなプラットフォームで動作する場合、問題はさらに深刻になります。
そのようなケースでは、あるユーザーはファイル共有 SaaS にファイルを保存するために使用し、別のユーザーはオンプレミスのデータを取得するために使用することができます。

## 攻撃シナリオの例

### シナリオ #1

ある開発者はデータベースからレコードを閲覧するためのシンプルなアプリケーションを作成しました。
開発者の ID を使用してデータベースにログインし、アプリケーション内に組み込まれた接続を作成します。
このアプリケーションでユーザーが実行するすべてのアクションは開発者の ID を使用してデータベースに問い合わせることになります。
悪意のあるユーザーはこれを利用し、このアプリケーションを使用して、アクセスしてはならないレコードを閲覧、修正、削除します。
データベースのログではすべての問い合わせがアプリ開発者である一人のユーザーによって行われたことが示されています。

### シナリオ #2

ある開発者は企業の従業員が自分の情報をフォームに入力できるようにするビジネスアプリケーションを作成しました。
フォームの回答を保存するために、開発者は個人の電子メールアカウントを使用します。
ユーザーはこのアプリが開発者の個人アカウントにデータを保存していることを知る由もありません。

### シナリオ #3

ある開発者はビジネスアプリケーションを作成して、それを管理者と共有しました。
その開発者は自分のユーザー ID を使用するようにアプリを設定します。
本来の目的から外れて、このアプリは開発者のユーザー ID を使用して、開発者の権限を昇格させることもできます。
管理者がアプリを使用すると、知らぬ間に開発者の権限を昇格してしまいます。

## 防止方法

- データベース/サービス/SaaS への接続をプロビジョニングする際、最小権限の原則を遵守する。
- アプリケーションではユーザーアカウントではなく専用のサービスアカウントまたはアプリケーションアカウントを使用する。
- アプリケーションでは接続ごとに異なる ID ではなく、すべての接続で一貫した単一の ID を使用する。これらの接続には専用のサービスアカウントまたはアプリケーションアカウントを使用する。
- これらの接続がアプリケーションを使用するユーザーによって共有されるか、ユーザーにその接続への直接アクセスを許可することによって共有されるかに関わらず、共有接続を通じて実行されるアクションの背後にいるアクターを特定するために、適切な監査証跡を維持する。

## 参考資料

- [Low Code High Risk - Enterprise Domination via Low Code Abuse, DEF CON 2022](https://www.youtube.com/watch?v=D3A62Rzozq4)
- [Watch Out for User Impersonation in Low-Code/No-Code Apps](https://www.darkreading.com/edge-articles/watch-out-for-user-impersonation-in-low-code-no-code-apps)
- [Do low-code / no-code platforms pose a security risk?](https://sdtimes.com/lowcode/do-low-code-no-code-platforms-pose-a-security-risk/)
- [Credential Sharing as a Service: The Hidden Risk of Low-Code/No-Code](https://www.darkreading.com/dr-tech/credential-sharing-as-a-service-hidden-risk-of-low-code-no-code)
